<!DOCTYPE html>
<html>
<head>
	<title>Adding Event to Google Calendar</title>
  <script>
		window.onload = function() {
			// Get the event name from the URL query parameter
			var params = new URLSearchParams(window.location.search);
			var eventName = params.get("event-name");

			// Check if the event name is empty
			if (!eventName) {
				alert("Please enter an event name");
				return;
			}
	//          var startDate = new Date().toISOString().slice(0, 10).replace(/-/g,""); //this worked but showed GMT always
			//this uses the user's timezone
			var startDate = new Date();
			var tzOffset = startDate.getTimezoneOffset();
			startDate.setMinutes(startDate.getMinutes() - tzOffset);
			startDate = startDate.toISOString().slice(0, 10).replace(/-/g, "");
			//alert(startDate);

			// Generate the Google Calendar URL and redirect to it
			var url = "https://www.google.com/calendar/render?action=TEMPLATE&text=" + encodeURIComponent(eventName) + "&dates=" + startDate + "/" + startDate;
			window.location.href = url;
			//console.log(url)
		}
	</script>
  </head>
<body>
	<h1>Adding Event.</h1>
	<p>One sec while we redirect you to Google Calendar...</p>
</body>
</html>
